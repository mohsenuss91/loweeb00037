{% extends '::base.html.twig' %}

{% block stylesheets %}
{{ parent() }}
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.3/themes/smoothness/jquery-ui.css">
{% endblock %}

{% block title %}{{ parent() }}{% endblock %}

{% block body %}

{% if not is_granted('IS_AUTHENTICATED_REMEMBERED') %}
<div>{{ render(controller('BaseUserBundle:Security:login', { 'id' : 1, 'booking' : booking, 'locale' : app.request.locale } )) }}</div>
{% trans_default_domain 'FOSUserBundle' %}

<div id="inscription" class="bloc_page_body222">
    <h2>
        Inscription
    </h2>
</div>
<div class="bloc_page_body3">
    <section> 
        <div class="forpar">
            <form {{ form_enctype(form) }} method="POST" class="fos_user_registration_register">
                {{ form_errors(form) }}
                <div>
                    <label>{{ form_label(form.gender, " ") }}</label>
                    {{ form_errors(form.gender) }}
                    {{ form_widget(form.gender) }}
                </div>
                <div>
                    <label>{{ form_label(form.firstname, "Nom") }}</label>
                    {{ form_errors(form.firstname) }}
                    {{ form_widget(form.firstname, { 'attr': {'class': 'ouardepp'} }) }}
                </div>
                <div>
                    <label>{{ form_label(form.secondename, "Prénom") }}</label>
                    {{ form_errors(form.secondename) }}
                    {{ form_widget(form.secondename, { 'attr': {'class': 'ouardepp'} }) }}
                </div>
                <div>
                    <label>{{ form_label(form.born, "Année de naissance") }}</label>
                    {{ form_errors(form.born) }}
                    {{ form_widget(form.born, { 'attr': {'class': 'ouardepp'} }) }}
                </div>
                <div>
                    <label>{{ form_label(form.phone, "Téléphone") }}</label>
                    {{ form_errors(form.phone) }}
                    {{ form_widget(form.phone, { 'attr': {'class': 'ouardepp'} }) }}
                </div>
                <div>
                    <label>{{ form_label(form.email, "Adresse mail") }}</label>
                    {{ form_errors(form.email) }}
                    {{ form_widget(form.email, { 'attr': {'class': 'ouardepp'} }) }}
                </div>
                <div>
                    <label>{{ form_label(form.plainPassword.first, "Mot de passe ") }}</label>
                    {{ form_errors(form.plainPassword.first) }}
                    {{ form_widget(form.plainPassword.first, { 'attr': {'class': 'ouardepp'} }) }}
                </div>
                <div>
                    <label>{{ form_label(form.plainPassword.second, "Confirmez le mot de passe ") }}</label>
                    {{ form_errors(form.plainPassword.second) }}
                    {{ form_widget(form.plainPassword.second, { 'attr': {'class': 'ouardepp'} }) }}
                </div>                   
                {{ form_rest(form) }}
                <div class="mr2">
                    <div class="mr6">
                        <input type="hidden" name="_target_path" value="/{{ app.request.locale }}/booking/{{ booking }}" />
                        <input type="hidden" name="red" value="{{ booking }}" />
                        <input class="trouvezi" type="submit" value="{% trans %}base.bledvoyage.booking.valider{% endtrans %}" />
                    </div>
                </div>
            </form>
        </div>
    </section>
</div>
{% else %}
<div class="bloc_page_body222">
    <h2>
        {% trans %}base.bledvoyage.booking.reservation{% endtrans %} 
    </h2>
</div>
<div class="bloc_page_body3">
    <section>
        <div class="infoparcourss">
            <div class="info_parcours">
                <p class="pgras1">{% trans %}base.bledvoyage.booking.recapitulatif{% endtrans %}</p>
                <div class="rectangle1">
                </div>
            </div>
            <div class="info_parcours">
                <p class="pgras">{% trans %}base.bledvoyage.booking.confirmation{% endtrans %}</p>
                <div class="rectangle">
                </div>
            </div>
        </div>
        <div class="forpar">
            <form method="post">
                <div class="dates">
                    <h2>
                        {% trans %}base.bledvoyage.booking.place_1{% endtrans %} 
                    </h2>
                    <h6>{% trans %}base.bledvoyage.booking.place_2{% endtrans %} </h6>
                    <img class="calendaro" alt="" src="{{ asset('bundles/basebledvoyage/images/interface/place.png') }}">
                </div>
                <div class="dates">
                    <div class="outplace">
                        <div class="inplace">
                            <label for="1">1 {% trans %}base.bledvoyage.booking.place{% endtrans %}</label>
                            <input type= "radio" name="nombre" value="1" id="1">
                        </div>
                    </div>
                    <div class="outplace">
                        <div class="inplace">
                            <label for="2">2 {% trans %}base.bledvoyage.booking.places{% endtrans %}</label>
                            <input type= "radio" name="nombre" value="2" id="2">
                        </div>
                    </div>
                    <div class="outplace">
                        <div class="inplace">
                            <label for="3">3 {% trans %}base.bledvoyage.booking.places{% endtrans %}</label>
                            <input type= "radio" name="nombre" value="3" id="3">
                        </div>
                    </div>
                    <div class="outplace">
                        <div class="inplace">
                            <label for="4">4 {% trans %}base.bledvoyage.booking.places{% endtrans %}</label>
                            <input type= "radio" name="nombre" value="4" id="4">
                        </div>
                    </div>
                    <div class="outplace">
                        <div class="inplace">
                            <label for="5">5 {% trans %}base.bledvoyage.booking.places{% endtrans %}</label>
                            <input type= "radio" name="nombre" value="5" id="5">
                        </div>
                    </div>
                    <div class="outplace">
                        <div class="inplace">
                            <label for="6">6 {% trans %}base.bledvoyage.booking.places{% endtrans %}</label>
                            <input type= "radio" name="nombre" value="6" id="6">
                        </div>
                    </div>
                    <div class="outplace">
                        <div class="inplace">
                            <label for="7">7 {% trans %}base.bledvoyage.booking.septplaces{% endtrans %}</label>
                            <input type= "radio" name="nombre" value="7" id="7">
                        </div>
                    </div>
                </div>
                <div class="dates">
                    <h2>
                        {% trans %}base.bledvoyage.booking.date{% endtrans %}
                    </h2>
                    <img class="calendaro" alt="" src="{{ asset('bundles/basebledvoyage/images/interface/calendaro.png') }}">
                </div>
                <div class="dates" id="personne">
                    {% set date = 0 %}
                    {% for data in product %}
                    {% if data.dateFin|date('Y-m-d') > 'now'|date('Y-m-d') %}
                        {% if data.dateDebut == data.dateFin %}
                        <div class="outdate">
                            <div class="indate">    
                                <label for="{{ data.dateDebut|date('d/m/Y') }}">{{ data.dateDebut|date('d/m/Y') }}</label>
                                <input type= "radio" id="{{ data.dateDebut|date('d/m/Y') }}" name="dateReserver" value="{{ data.dateDebut|date('d/m/Y') }}">
                            </div>
                        </div>
                        {% else %}
                        <div class="outdatea">
                            <div class="indateà">    
                                <label for="{{ data.dateDebut|date('d/m/Y') }}">Du {{ data.dateDebut|date('d/m/Y') }}, au {{ data.dateFin|date('d/m/Y') }}</label>
                                <input type= "radio" id="{{ data.dateDebut|date('d/m/Y') }}" name="dateReserver" value="{{ data.dateDebut|date('d/m/Y') }}">
                            </div>
                        </div>
                        {% endif %}
                        {% set date = date + 1 %}
                    {% else %}
                        {% if data.dateDebut == data.dateFin %}
                        <div class="outdate" >
                            <div class="indate">
                                <label>
                                    {{ data.dateDebut|date('d/m/Y') }}
                                </label>
                                <p>{% trans %}base.bledvoyage.booking.complet{% endtrans %}</p>
                                <img class="calendara" alt="Image" src="{{ asset('bundles/basebledvoyage/images/interface/sad.png') }}">
                            </div>
                        </div>
                        {% else %}
                        <div class="outdatea" >
                            <div class="indateo">
                                <label>
                                    Du {{ data.dateDebut|date('d/m/Y') }}, au {{ data.dateFin|date('d/m/Y') }}
                                </label>
                                <p>{% trans %}base.bledvoyage.booking.complet{% endtrans %}</p>
                                <img class="calendara" alt="Image" src="{{ asset('bundles/basebledvoyage/images/interface/sad.png') }}">
                            </div>
                        </div>
                        {% endif %}
                    {% endif %}
                    {% endfor %}
                </div>
                <div class="dates" id="groupe" style="display:none;">
                    <input type= "text" name="dateReserverGroupe" class="datepicker">
                </div>
                <div class="dates">
                    <h2>
                        {% trans %}base.bledvoyage.booking.promo_1{% endtrans %}
                    </h2>
                    <h6>{% trans %}base.bledvoyage.booking.promo_2{% endtrans %}</h6>
                    <img class="calendaro" alt="Image" src="{{ asset('bundles/basebledvoyage/images/interface/promo.png') }}">
                </div>
                <div class="mr7">
                    <div class="mr4u">
                        <label for="mdp">{% trans %}base.bledvoyage.booking.promo_3{% endtrans %}</label>
                        <input class="ouardep" type="text" name="promo0" maxlength="8" />
                        <div id="cadre"></div>
                        <div class="casouty">
                            <input class="anou" type="button" value=" + " onclick="plus()" />
                            <input class="anou" type="button" style="display:none" id="sup" value=" - " onclick="moins()" />
                        </div>
                    </div>
                </div>
                <div class="mr6">
                    {% if date != 0 %}
                    <input class="cherchez" name="Valider" type="submit" value="{% trans %}base.bledvoyage.booking.valider{% endtrans %}" id="booking"/>
                    {% else %}
                    <input class="cherchez" name="Complet" type="botton" value="{% trans %}base.bledvoyage.booking.complet{% endtrans %}"/>
                    {% endif %}
                </div>
            </form>
        </div>
    </section>
    <div class="sectiono">
        <div class="mr1i">
            <div class="mr2i">
                <h4>{% trans %}base.bledvoyage.booking.aide_1{% endtrans %}</h4>
            </div>
            <div class="mr2i">
                <p>
                    {% trans %}base.bledvoyage.booking.aide_2{% endtrans %}
                </p>
            </div>
            <div class="appel">
                <img alt="0 556 179 774" src="{{ asset('bundles/basebledvoyage/images/interface/phone.png') }}">
                <p>0 556 179 774</p>
            </div>
        </div>
    </div>
    <div class="plusrc">
        <p>
            <a href="{{ path('base_bledvoyage_homepage') }}">{% trans %}base.bledvoyage.booking.revenir{% endtrans %}</a>
        </p>
    </div>
</div>
{% endif %}

{% endblock %}

{% block javascripts %}
<script type="text/javascript">
var c,c2, ch;
// ajouter un champ avec son "name" propre;
function plus(){
    c=document.getElementById('cadre');
    c2=c.getElementsByTagName('input');
    ch=document.createElement('input');
    ch.className = "ouardep";
    ch.setAttribute('type','text');
    ch.setAttribute('name','promo'+(c2.length+1));
    ch.maxLength = "8";
    c.appendChild(ch);
    document.getElementById('sup').style.display='inline';
}
// supprimer le dernier champ;
function moins(){
    if(c2.length>0){c.removeChild(c2[c2.length-1])}
    if(c2.length===0){document.getElementById('sup').style.display='none'};
}

// safari
/*
var forms = document.getElementsByTagName('form');
for (var i = 0; i < forms.length; i++) {
    forms[i].noValidate = true;

    forms[i].addEventListener('submit', function(event) {
        //Prevent submission if checkValidity on the form returns false.
        if (!event.target.checkValidity()) {
            event.preventDefault();
            //Implement you own means of displaying error messages to the user here.
            alert('Tous les champs sont obligatoire')
        }
    }, false);
}
*/
</script>
<script src="//code.jquery.com/ui/1.11.3/jquery-ui.js"></script>
<script>
$(function(){
    $.datepicker.regional['fr'] = {
        closeText: 'Fermer',
        prevText: 'Précédent',
        nextText: 'Suivant',
        currentText: 'Aujourd\'hui',
        monthNames: ['Janvier','Février','Mars','Avril','Mai','Juin',
        'Juillet','Août','Septembre','Octobre','Novembre','Décembre'],
        monthNamesShort: ['Janv.','Févr.','Mars','Avril','Mai','Juin',
        'Juil.','Août','Sept.','Oct.','Nov.','Déc.'],
        dayNames: ['Dimanche','Lundi','Mardi','Mercredi','Jeudi','Vendredi','Samedi'],
        dayNamesShort: ['Dim.','Lun.','Mar.','Mer.','Jeu.','Ven.','Sam.'],
        dayNamesMin: ['D','L','M','M','J','V','S'],
        weekHeader: 'Sem.',
        dateFormat: 'dd/mm/yy',
        firstDay: 7,
        isRTL: false,
        showMonthAfterYear: false,
        yearSuffix: ''
    };
    $.datepicker.setDefaults( $.datepicker.regional[ "" ] );
    $( ".datepicker" ).datepicker( $.datepicker.regional[ "fr" ] );
});
$(function() {
    $('input.datepicker').datepicker();
    $('#booking').on('click', function(){
        if ($('input[name=nombre]:checked').length <= 0) {
            alert('Vous devez selectionner le nombre de places');
            return false;
        }else if ($('input[name=dateReserver]:checked').length <= 0) {
            alert('Vous devez selectionner une date de réservation');
            return false;
        }else{
            return true;
        }
    });
});
</script>
<!--
<script type="text/javascript">
  $(document).ready(function() {
    // On récupère la balise <div> en question qui contient l'attribut « data-prototype » qui nous intéresse.
    var $container = $('div#base_bledvoyagebundle_booking_promo');

    // On ajoute un lien pour ajouter une nouvelle catégorie
    var $addLink = $('<input type="button" value=" + " id="add_category" />');
    $container.append($addLink);

    // On ajoute un nouveau champ à chaque clic sur le lien d'ajout.
    $addLink.click(function(e) {
      addCategory($container);
      e.preventDefault(); // évite qu'un # apparaisse dans l'URL
      return false;
    });

    // On définit un compteur unique pour nommer les champs qu'on va ajouter dynamiquement
    var index = $container.find(':input').length;

    // On ajoute un premier champ automatiquement s'il n'en existe pas déjà un (cas d'une nouvelle annonce par exemple).
    if (index === 0) {
      addCategory($container);
    } else {
      // Pour chaque catégorie déjà existante, on ajoute un lien de suppression
      $container.children('div').each(function() {
        addDeleteLink($(this));
      });
    }

    // La fonction qui ajoute un formulaire Categorie
    function addCategory($container) {
      // Dans le contenu de l'attribut « data-prototype », on remplace :
      // - le texte "__name__label__" qu'il contient par le label du champ
      // - le texte "__name__" qu'il contient par le numéro du champ
      var $prototype = $($container.attr('data-prototype').replace(/__name__label__/g, '')
          .replace(/__name__/g, index));

      // On ajoute au prototype un lien pour pouvoir supprimer la catégorie
      addDeleteLink($prototype);

      // On ajoute le prototype modifié à la fin de la balise <div>
      $container.append($prototype);

      // Enfin, on incrémente le compteur pour que le prochain ajout se fasse avec un autre numéro
      index++;
    }

    // La fonction qui ajoute un lien de suppression d'une catégorie
    function addDeleteLink($prototype) {
      // Création du lien
      $deleteLink = $('<input type="button" value=" - " />');

      // Ajout du lien
      $prototype.append($deleteLink);

      // Ajout du listener sur le clic du lien
      $deleteLink.click(function(e) {
        $prototype.remove();
        e.preventDefault(); // évite qu'un # apparaisse dans l'URL
        return false;
      });
    }
  });
</script>
-->
{% endblock %}
